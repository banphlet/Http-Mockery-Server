{"ast":null,"code":"'use strict';\n\nimport _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/home/kudobuzzhq/Desktop/CODES/mockery-server/pages/users.js\";\nimport React from 'react';\nimport { WithProvider } from \"../components/hoc\";\nimport { Page, Card, PageActions, TextField } from \"@shopify/polaris\";\nimport { message } from 'antd';\nimport Router from 'next/router';\nimport { parseCookies, setCookie, destroyCookie } from 'nookies';\nexport var User =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(User, _React$Component);\n\n  function User() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, User);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(User)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      email: \"\",\n      name: \"\"\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"makeRequest\",\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var loader, user;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              loader = message.loading(\"authenticating...\");\n              _context.prev = 1;\n              _context.next = 4;\n              return fetch('/users', {\n                method: \"POST\",\n                body: _JSON$stringify(_this.state),\n                headers: {\n                  'Content-Type': 'application/json'\n                }\n              }).then(function (res) {\n                return res.json();\n              });\n\n            case 4:\n              user = _context.sent;\n              console.log(user);\n              setTimeout(loader, 10);\n              message.success(\"authenticated\");\n              setCookie(null, \"__token\", user.data.jwt, {\n                maxAge: 60 * 50\n              });\n              Router.replace(\"/generate\");\n              _context.next = 15;\n              break;\n\n            case 12:\n              _context.prev = 12;\n              _context.t0 = _context[\"catch\"](1);\n              setTimeout(loader, 10);\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 12]]);\n    })));\n\n    return _this;\n  }\n\n  _createClass(User, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(Page, {\n        singleColumn: true,\n        title: \"Add payment method\",\n        primaryAction: {\n          content: 'Save',\n          disabled: true\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 39\n        },\n        __self: this\n      }, React.createElement(Card, {\n        title: \"Authenticate or create new user\",\n        sectioned: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 44\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        label: \"Email\",\n        value: this.state.email,\n        type: \"email\",\n        onChange: function onChange(text) {\n          return _this2.setState({\n            email: text\n          });\n        },\n        autoFocus: true,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 45\n        },\n        __self: this\n      }), React.createElement(TextField, {\n        label: \"Store name\",\n        value: this.state.name,\n        onChange: function onChange(text) {\n          return _this2.setState({\n            name: text\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 52\n        },\n        __self: this\n      })), React.createElement(PageActions, {\n        primaryAction: {\n          content: 'Save',\n          disabled: !this.state.email || !this.state.name,\n          onAction: this.makeRequest\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return User;\n}(React.Component);\nexport default WithProvider(User);","map":{"version":3,"sources":["/home/kudobuzzhq/Desktop/CODES/mockery-server/pages/users.js"],"names":["React","WithProvider","Page","Card","PageActions","TextField","message","Router","parseCookies","setCookie","destroyCookie","User","email","name","loader","loading","fetch","method","body","state","headers","then","res","json","user","console","log","setTimeout","success","data","jwt","maxAge","replace","content","disabled","text","setState","onAction","makeRequest","Component"],"mappings":"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","sourcesContent":["'use strict'\nimport React from 'react'\nimport { WithProvider } from \"../components/hoc\";\nimport {  Page, Card, PageActions, TextField } from \"@shopify/polaris\";\nimport { message } from 'antd';\nimport Router from 'next/router'\nimport { parseCookies, setCookie, destroyCookie } from 'nookies'\n\nexport  class User extends React.Component {\nstate = {\n    email: \"\",\n    name: \"\"\n}\n\nmakeRequest = async ()=>{\n    const loader = message.loading(\"authenticating...\")\n    try {\n       const user = await fetch('/users', {\n            method: \"POST\",\n            body: JSON.stringify(this.state),\n            headers: {\n                'Content-Type': 'application/json'       \n               }\n        }).then(res=> res.json())\n        console.log(user)\n        setTimeout(loader, 10);\n        message.success(\"authenticated\")\n        setCookie(null, \"__token\", user.data.jwt, { maxAge :  60 * 50})\n        Router.replace(\"/generate\")\n\n    } catch (error) {\n        setTimeout(loader, 10);\n    }\n}\n\n\n    render () {\n        return (\n            <Page\n            singleColumn\n            title=\"Add payment method\"\n            primaryAction={{content: 'Save', disabled: true}}\n          >\n            <Card title=\"Authenticate or create new user\" sectioned>\n            <TextField\n        label=\"Email\"\n        value={this.state.email}\n        type=\"email\"\n        onChange={(text)=> this.setState({ email: text })}\n        autoFocus\n      />\n         <TextField\n        label=\"Store name\"\n        value={this.state.name}\n        onChange={(text)=> this.setState({ name: text })}\n      />\n            </Card>\n            <PageActions\n              primaryAction={{content: 'Save', disabled: (!this.state.email) || !this.state.name,\n              onAction: this.makeRequest\n            \n            }\n            \n            }\n            />\n          </Page>\n        )\n    }\n}\n\nexport default WithProvider(User)"]},"metadata":{},"sourceType":"module"}